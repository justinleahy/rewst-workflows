{"version":2,"exportedAt":"2023-10-02T15:09:15.637764+00:00","signing":{"cert":"-----BEGIN CERTIFICATE-----\nMIICazCCAfGgAwIBAgIUFJtHAR8D+ZfChHcAXHemH7s8zRowCgYIKoZIzj0EAwIwfDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkZMMQ4wDAYDVQQHEwVUYW1wYTEOMAwGA1UEChMFUmV3c3QxEzARBgNVBAsTClJld3N0IERldnMxKzApBgNVBAMTImxvY2FsIFJld3N0IEltcG9ydC9FeHBvcnQgQ0EyIHYxLjEwHhcNMjIwNjAzMTkwMDU1WhcNMjUwNTIzMTkwMTI1WjBDMQswCQYDVQQGEwJVUzELMAkGA1UECBMCRkwxDjAMBgNVBAcTBVRhbXBhMRcwFQYDVQQDEw5sb2NhbC5yZXdzdC5pbzB2MBAGByqGSM49AgEGBSuBBAAiA2IABMcTJzyLIvX1+3545EJbFeNVjahxVq6TFQ7n/IYZs4yEMQzDWZjAyHhJPZk3Dxq/wFzesXMYJu41rhxfz7AZh15LtFGfy9V2B4X5KH7sGJWqOan0mabuF83llruTLA/NQaNtMGswDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBTDePOSC6hckrg6usrK2giZv9GxpjAfBgNVHSMEGDAWgBTojdemsJqfnB19iyMxmIi3OGYw6TAZBgNVHREEEjAQgg5sb2NhbC5yZXdzdC5pbzAKBggqhkjOPQQDAgNoADBlAjEA8NsLnuGhfTPC7dB0ojWf5WmH64qFZuPFD6Q0RwGYO0D1Tn2x5+/37kW3HFcGHV0wAjBM7LSidsc7E9+fmcesnN5hM34eGMP+YWCoEeFIPPANXQKemAgUVf35iXyU64sVEC4=\n-----END CERTIFICATE-----","hash":"sha512","signature":"MGUCMBDO+ztBpI6U2uvXr9Z2qnQWdmJwUsprwt6FlPi/nZePMdMyksoDbavX+40njseGowIxAOkkFcQoSLmGpS8vPy00EmX/+Gn5ttE/9aryWSDSYR6UJwBTrqgPIdIyuSOAIYEITg=="},"objects":{"transition_id:2iUcKEDMXK2F1AXpb2fJ5xPUYFv3M4AgNJ9vUQCdoZVY":{"type":"transition_id","content_hash":"8D7q6AtUkv5fE2Jntn6qUajHfztY4686nanipGUZvLXG","hash":"ERM1SpCdWDJi5SZcMPch4qECyZgMfPZAwiQT7WZ2K9Au","fields":{"id":"815d0675-6d10-4f60-a93c-06217d5106da"}},"action:F8JhaU78D1vCZTc8JToScQvEsmKYF7U54QTcr8YqVnuS":{"type":"action","content_hash":"CdPL6KHuhM7mBvTHi4QnQbxCitnoxuRrq1BfHNnQYzKB","hash":"Arr2RCEM96WqU2EkvigszSfsW9GZHa4HJC5a1fL9qZ5g","fields":{"ref":"core.noop"}},"transition_id:5DR7i8nKL4NpvwWhfnCoGHRdXeXmV3itp3UQ81En92ai":{"type":"transition_id","content_hash":"3vWFmdRRtZJhMZCCz44TqA3HqiJx5tR9TUC4UqQTVXuA","hash":"A2ios2RvNQQYozp2j6HBAaiZvHiszUKmjBncA6Vo57XM","fields":{"id":"b6d2a2d3-aec7-4973-8113-147921fb5e1b"}},"workflow_task_id:7uFY68cAKyWhFxBG7xNdfjC5vZ7eGjjy4QyUqywJX63Z":{"type":"workflow_task_id","content_hash":"7C4LztxY3rHA4RwYbGbFPVXtP99m6urAm4Di7pQjrDxu","hash":"BCvoV6YFtobha4QGxhfKosN2W5fYtrXLe9gwpZeZKeSD","fields":{"id":"79c9fa0a355d4152850b5c2e5b5e5831"}},"action:3j6mJrvRWfDzTNVnPFi9zxuZAqJffnLwzE8r7MKUaGcT":{"type":"action","content_hash":"8XMYELptDjmURWp384vAzqCUTbAHGitrSUYQcFw8WgG1","hash":"3HaRdpFugxotbWzGDjFSkCYEtNYEAkXnh8N99Dg5reKu","fields":{"ref":"cw_control.invoke_command"}},"workflow_task_id:ENESfueULYsQCLNXzm1WsiLDHETaCWUEQUxjgL7vuP9w":{"type":"workflow_task_id","content_hash":"AsNSWSgG4zQDLxoDWzoKRJRLR5jzHmLuyTkNqzJQjESh","hash":"GPjYQksDfyYmoAJojJDPHbhaTgt6eBF5f5gLKiheakFN","fields":{"id":"d0ef16cf9e854f8bbafb98534342a3aa"}},"template:BhpALhi5Yis1ksYouwVGEPDCLXGihf1G3QnxtZyKZQ3q":{"type":"template","content_hash":"A38jbwYruqBcBXURxfoRUH5nMEScSLRM3W1D8RQfhPWk","hash":"2geFLLQLGcCsN6Uc6rtJn657rSAWBpQtJxkwc9eke4eX","fields":{"body":"function ConvertTo-ExcelColumn {\r\n    param (\r\n        [int]$Number\r\n    )\r\n\r\n    $result = \"\"\r\n    while ($Number -gt 0) {\r\n        $remainder = ($Number - 1) % 26  # Get the remainder when divided by 26\r\n        $result = [char]([int][char]'A' + $remainder) + $result  # Convert to the corresponding character\r\n        $Number = [math]::Floor(($Number - 1) / 26)  # Reduce the number by 1 and divide by 26\r\n    }\r\n\r\n    return $result\r\n}\r\n\r\n$Raw_Data = '{{ CTX.validated_csv_data }}'\r\n$Headers = '{{ CTX.headers}}'.Split(\",\")\r\n$Table_Name = '{{ CTX.table_name }}'\r\n$File_Name = '{{ CTX.file_name }}.xlsx'\r\n$File_Location = '{{ CTX.file_location }}' + \"\\$File_Name\"\r\n\r\n$Data = $Raw_Data | ConvertFrom-Csv\r\n$Excel_Column_Number = ($Data[0] | Get-Member -MemberType Properties).Count\r\n$Excel_Column = ConvertTo-ExcelColumn -Number $Excel_Column_Number\r\n$Excel_Range = \"A1:\" + $Excel_Column + ($Data.Length + 1)\r\n\r\n$Excel = New-Object -ComObject Excel.Application\r\n$Excel.Visible = $false\r\n$Excel.DisplayAlerts = $false\r\n$Workbook = $Excel.Workbooks.Add(1)\r\n$Worksheet = $Workbook.Worksheets.Item(1)\r\n$Worksheet.Name = $Table_Name\r\n\r\n$Table = $Worksheet.ListObjects.Add(\r\n    [Microsoft.Office.Interop.Excel.XlListObjectSourceType]::xlSrcRange,\r\n    $worksheet.Range($Excel_Range),\r\n    $null,\r\n    [Microsoft.Office.Interop.Excel.XlYesNoGuess]::xlYes\r\n)\r\n$Table.Name = $Table_Name\r\n\r\n# Create Headers\r\nfor ($index = 1; $index -le $Headers.Count; $index++) {\r\n    $Header = $Headers[$index - 1]\r\n    $Table.ListColumns.Item($index).Name = $Header\r\n}\r\n\r\n# Insert Data into Table\r\nfor ($rowIndex = 2; $rowIndex -lt ($Data.Length + 2); $rowIndex++) {\r\n    for ($colIndex = 1; $colIndex -lt ($Headers.Length + 1); $colIndex++) {\r\n        $Header = $Headers[$colIndex - 1]\r\n        $Information = $Data[$rowIndex - 2].$Header\r\n        $Worksheet.Cells.Item($rowIndex, $colIndex) = $Information\r\n    }\r\n}\r\n\r\n$Worksheet.Columns.AutoFit() > $null\r\n$Worksheet.SaveAs($File_Location)\r\n$File_Base64 = [convert]::ToBase64String((Get-Content -Path $File_Location -Encoding Byte))\r\n$Excel.Quit()\r\nreturn $File_Base64","contentType":"script","language":"powershell"},"nonfunctional_fields":{"description":"Creates an excel spreadsheet and inserts a table with corresponding data. Returns the file encoded in a Base64 string.","name":"Create Excel Table"}},"workflow:431ksqEgPxkT5j23HMbnUc4kQf6xQx932Eng1gtdQX2H":{"type":"workflow","content_hash":"EHtyetsBKqhKPs65avdrrXTXqUxaK9iCxNc3GxAYMkxq","hash":"DqcF5Zsh9JV7Nh3AGmKoBQYyZPs8jaiMAYvxuhNqbAvv","fields":{"humanSecondsSaved":0,"notes":[],"output":[{"base64_string":"{{ CTX.base64_string }}"}],"parameters":{"headers":{"type":"string","required":true,"multiline":false},"csv_data":{"type":"string","required":true,"multiline":false},"file_name":{"type":"string","required":true,"multiline":false},"table_name":{"type":"string","required":true,"multiline":false}},"tasks":[{"id":"@@@workflow_task_id_ref1@@@","action":{"id":"@@@action_ref1@@@"},"humanSecondsSaved":0,"input":{},"isMocked":false,"join":0,"mockInput":{"mock_result":{}},"name":"data_validation","next":[{"do":["@@@workflow_task_id_ref2@@@"],"from":null,"id":"@@@transition_id_ref1@@@","publish":[{"key":"validated_csv_data","value":"{{- CTX.csv_data|regex_replace(\"'\", \"''\", ignorecase=True) -}}"}],"to":null,"when":"{{ SUCCEEDED }}"}],"packOverrides":[],"publishResultAs":"","retry":null,"runAsOrgId":"","timeout":600,"transitionMode":"FOLLOW_ALL","with":null},{"id":"@@@workflow_task_id_ref2@@@","action":{"id":"@@@action_ref2@@@"},"humanSecondsSaved":0,"input":{"script":"{{ template(\"@@@template_ref1@@@\") }}","session_id":"1aaeed9c-bf9b-4977-ae40-b998edbf4710","session_group":"All Machines"},"isMocked":false,"join":0,"mockInput":{"mock_result":{}},"name":"create_table_string","next":[{"do":[],"from":null,"id":"@@@transition_id_ref2@@@","publish":[{"key":"base64_string","value":"{{ RESULT.body.Response }}"}],"to":null,"when":"{{ RESULT.body.IsError == false }}"}],"packOverrides":[],"publishResultAs":"","retry":null,"runAsOrgId":"","timeout":3600,"transitionMode":"FOLLOW_ALL","with":null}],"timeout":28800,"type":"STANDARD","varsSchema":{"file_location":{"type":"string","default":"C:\\Windows\\system32\\config\\systemprofile\\Documents","required":true,"multiline":false}}},"nonfunctional_fields":{"description":"","name":"Create Excel Spreadsheet with Table","parameters.csv_data.description":"Store in csv format with headers","parameters.csv_data.label":"Data","parameters.file_name.description":"Do not include file extension","parameters.file_name.label":"File Name","parameters.headers.description":"Comma separated.","parameters.headers.label":"Headers","parameters.table_name.description":"Name of table and worksheet","parameters.table_name.label":"Table Name","tasks[0].description":"Action that does nothing","tasks[0].metadata":{"x":744,"y":336},"tasks[0].next[0].label":"","tasks[1].description":"Action to run a command template on an agent","tasks[1].metadata":{"x":744,"y":480},"tasks[1].next[0].label":"No Error","varsSchema.file_location.description":"The location you wish to store the file","varsSchema.file_location.label":"File Location"},"references":{"action_ref2":{"kind":"string","type":"action","src_key_hash":"3j6mJrvRWfDzTNVnPFi9zxuZAqJffnLwzE8r7MKUaGcT","content_hash":"8XMYELptDjmURWp384vAzqCUTbAHGitrSUYQcFw8WgG1","locations":["tasks[1].action.id"]},"workflow_task_id_ref2":{"kind":"string","type":"workflow_task_id","src_key_hash":"ENESfueULYsQCLNXzm1WsiLDHETaCWUEQUxjgL7vuP9w","content_hash":"AsNSWSgG4zQDLxoDWzoKRJRLR5jzHmLuyTkNqzJQjESh","locations":["tasks[1].id","tasks[0].next[0].do[0]"]},"transition_id_ref2":{"kind":"string","type":"transition_id","src_key_hash":"2iUcKEDMXK2F1AXpb2fJ5xPUYFv3M4AgNJ9vUQCdoZVY","content_hash":"8D7q6AtUkv5fE2Jntn6qUajHfztY4686nanipGUZvLXG","locations":["tasks[1].next[0].id"]},"workflow_task_id_ref1":{"kind":"string","type":"workflow_task_id","src_key_hash":"7uFY68cAKyWhFxBG7xNdfjC5vZ7eGjjy4QyUqywJX63Z","content_hash":"7C4LztxY3rHA4RwYbGbFPVXtP99m6urAm4Di7pQjrDxu","locations":["tasks[0].id"]},"transition_id_ref1":{"kind":"string","type":"transition_id","src_key_hash":"5DR7i8nKL4NpvwWhfnCoGHRdXeXmV3itp3UQ81En92ai","content_hash":"3vWFmdRRtZJhMZCCz44TqA3HqiJx5tR9TUC4UqQTVXuA","locations":["tasks[0].next[0].id"]},"template_ref1":{"kind":"string","type":"template","src_key_hash":"BhpALhi5Yis1ksYouwVGEPDCLXGihf1G3QnxtZyKZQ3q","content_hash":"A38jbwYruqBcBXURxfoRUH5nMEScSLRM3W1D8RQfhPWk","locations":["tasks[1].input.script"]},"action_ref1":{"kind":"string","type":"action","src_key_hash":"F8JhaU78D1vCZTc8JToScQvEsmKYF7U54QTcr8YqVnuS","content_hash":"CdPL6KHuhM7mBvTHi4QnQbxCitnoxuRrq1BfHNnQYzKB","locations":["tasks[0].action.id"]}},"dependencies":["transition_id:2iUcKEDMXK2F1AXpb2fJ5xPUYFv3M4AgNJ9vUQCdoZVY","action:F8JhaU78D1vCZTc8JToScQvEsmKYF7U54QTcr8YqVnuS","transition_id:5DR7i8nKL4NpvwWhfnCoGHRdXeXmV3itp3UQ81En92ai","workflow_task_id:7uFY68cAKyWhFxBG7xNdfjC5vZ7eGjjy4QyUqywJX63Z","action:3j6mJrvRWfDzTNVnPFi9zxuZAqJffnLwzE8r7MKUaGcT","workflow_task_id:ENESfueULYsQCLNXzm1WsiLDHETaCWUEQUxjgL7vuP9w","template:BhpALhi5Yis1ksYouwVGEPDCLXGihf1G3QnxtZyKZQ3q"]}},"__typename":"ExportBundle"}